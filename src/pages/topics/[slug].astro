---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

export const prerender = true;

export async function getStaticPaths() {
  const topics = await getCollection('topics');
  return topics.map((topic) => ({
    params: { slug: topic.slug },
    props: { topic }
  }));
}

const { topic } = Astro.props;
const { Content } = await topic.render();
---

<BaseLayout title={topic.data.title} description={topic.data.description}>
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "TechArticle",
    "headline": topic.data.title,
    "description": topic.data.description,
    "datePublished": topic.data.date.toISOString().slice(0, 10),
    "author": { "@type": "Person", "name": "Turtleand", "url": "https://turtleand.com" },
    "isAccessibleForFree": true,
    "url": `https://chain.turtleand.com/topics/${topic.slug}`
  })} />
  <div class="article-header">
    <div class="article-meta">
      <a class="pill" href="/">‚Üê Back</a>
      <span class="article-date">{topic.data.date.toISOString().slice(0, 10)}</span>
    </div>
    <h1>{topic.data.title}</h1>
    <p>{topic.data.description}</p>
  </div>
  <article class="content-article">
    <Content />
  </article>
</BaseLayout>
